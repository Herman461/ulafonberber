<template>
  <div class="base-page" :class="{done: animationDone}">

    <div @scroll="expandFirstCol" :class="{active: (activeColumn === 1)}" :style="calculateWidth(columnWidth[0])" class="page__block">
      <slot name="first-block"></slot>
    </div>
    <div @scroll="expandSecondCol" :class="{active: (activeColumn === 2)}" :style="calculateWidth(columnWidth[1])" class="page__block">
      <slot name="second-block"></slot>
    </div>
    <div @scroll="expandThirdCol" :class="{active: (activeColumn === 3)}" :style="calculateWidth(columnWidth[2])" class="page__block">
      <slot name="third-block"></slot>
    </div>
  </div>
</template>


<script>
import pageInstanceState from "@/pageInstance/page-instance.state";

export default {
  name: 'BasePage',
  methods: {
    calculateWidth(width) {
      if (!width) {
        return {
          display: "none"
        }
      }

      let property
      if (width.includes('auto')) {
        property = `1 1 ${width}`
      } else if (width.includes('px')) {
        property = `0 0 ${width}`
      } else if (width.includes('%')) {
        property = `0 1 ${width}`
      }

      return {
        flex: property
      }
    },
    expandFirstCol() {
      if (pageInstanceState.activeColumn !== 1) {
        pageInstanceState.activeColumn = 1
      }
    },
    expandSecondCol() {
      if (pageInstanceState.activeColumn !== 2) {
        pageInstanceState.activeColumn = 2
      }
    },
    expandThirdCol() {
      if (pageInstanceState.activeColumn !== 3) {
        pageInstanceState.activeColumn = 3
      }
    }
  },
  computed: {
    columnWidth() {

      return pageInstanceState.currentColumnWidth
    },
    activeColumn() {
      return pageInstanceState.activeColumn
    },
    isLoading() {
      return pageInstanceState.isLoading
    },
    animationDone() {
      return pageInstanceState.animation.done
    }
  },

}
</script>


<style scoped lang="scss">

</style>
